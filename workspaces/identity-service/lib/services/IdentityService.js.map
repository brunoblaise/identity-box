{"version":3,"sources":["../../source/services/IdentityService.js"],"names":["IdentityService","servicePath","dispatcher","Service","create","onMessage","method","params","dispatch","e","errorResponse","message","Error","server","start"],"mappings":";;;;;;;AAAA;;;;;;;;;;IAEMA,e,GA4BJ,+BAGG;AAAA;;AAAA,MAFDC,WAEC,QAFDA,WAEC;AAAA,MADDC,UACC,QADDA,UACC;;AAAA;;AAAA;;AAAA,iCA5BK,YAAM;AACZ,WAAOC,eAAQC,MAAR,CAAe;AACpBH,MAAAA,WAAW,EAAE,KAAI,CAACA,WADE;AAEpBI,MAAAA,SAAS,EAAE,KAAI,CAACA;AAFI,KAAf,CAAP;AAID,GAuBE;;AAAA;AAAA,kCArBS,kBAA8B;AAAA,UAArBC,MAAqB,SAArBA,MAAqB;AAAA,UAAbC,MAAa,SAAbA,MAAa;;AACxC,UAAI;AACF,eAAO,KAAI,CAACL,UAAL,CAAgBM,QAAhB,CAAyB;AAC9BF,UAAAA,MAAM,EAANA,MAD8B;AAE9BC,UAAAA,MAAM,EAANA;AAF8B,SAAzB,CAAP;AAID,OALD,CAKE,OAAOE,CAAP,EAAU;AACV,eAAO,KAAI,CAACC,aAAL,CAAmBJ,MAAnB,EAA2BG,CAAC,CAACE,OAA7B,CAAP;AACD;AACF,KAYE;;AAAA;AAAA;AAAA;AAAA;;AAAA,yCAVa,UAACL,MAAD,EAASK,OAAT;AAAA,WAAsB;AACpCL,MAAAA,MAAM,YAAKA,MAAL,WAD8B;AAEpCC,MAAAA,MAAM,EAAE,CACN;AAAEI,QAAAA,OAAO,EAAPA;AAAF,OADM;AAF4B,KAAtB;AAAA,GAUb;;AACD,OAAKV,WAAL,GAAmBA,WAAnB;AACA,OAAKC,UAAL,GAAkBA,UAAlB;AACD,C;;;;gBAlCGF,e,YAoCY,iBAGV;AAAA,MAFJC,WAEI,SAFJA,WAEI;AAAA,MADJC,UACI,SADJA,UACI;;AACJ,MAAI,CAACA,UAAL,EAAiB;AACf,UAAM,IAAIU,KAAJ,CAAU,gDAAV,CAAN;AACD;;AACD,MAAMC,MAAM,GAAG,IAAIb,eAAJ,CAAoB;AACjCC,IAAAA,WAAW,EAAXA,WADiC;AAEjCC,IAAAA,UAAU,EAAVA;AAFiC,GAApB,CAAf;AAKA,SAAOW,MAAM,CAACC,KAAP,EAAP;AACD,C","sourcesContent":["import { Service } from '@identity-box/utils'\n\nclass IdentityService {\n  serviceRegistry\n\n  start = () => {\n    return Service.create({\n      servicePath: this.servicePath,\n      onMessage: this.onMessage\n    })\n  }\n\n  onMessage = async ({ method, params }) => {\n    try {\n      return this.dispatcher.dispatch({\n        method,\n        params\n      })\n    } catch (e) {\n      return this.errorResponse(method, e.message)\n    }\n  }\n\n  errorResponse = (method, message) => ({\n    method: `${method}-error`,\n    params: [\n      { message }\n    ]\n  })\n\n  constructor ({\n    servicePath,\n    dispatcher\n  }) {\n    this.servicePath = servicePath\n    this.dispatcher = dispatcher\n  }\n\n  static create = ({\n    servicePath,\n    dispatcher\n  }) => {\n    if (!dispatcher) {\n      throw new Error(\"Can't do anything without Dispatcher instance!\")\n    }\n    const server = new IdentityService({\n      servicePath,\n      dispatcher\n    })\n\n    return server.start()\n  }\n}\n\nexport { IdentityService }\n"],"file":"IdentityService.js"}